# updates local ledger FROM global ledger
from blockchain.lib import Ledger,Transaction
import sys


# python op.py add <FQDN> <HITS>
# python op.py disable <FQDN>
# python op.py enable <FQDN>

def main (argv):
    transaction = Transaction()
    if argv[2] not in validDomains:
        print ("Domain not found in VALID domains!")
        return 1

    if argv[1] == "disable":
        print ("Disabled FQDN: " + argv[2])
        transaction.enabled(argv[2], "False")
    elif argv[1] == "enable":
        print ("Enabled FQDN: " + argv[2])
        transaction.enabled(argv[2], "True")
    elif argv[1] == "add":
        print ("Add FQDN: "+ argv[2])
        if argv[3]:
            transaction.add(argv[2], argv[3])
        else:
            transaction.add(argv[2], "0")
    else:
        print ("Invalid command!")

# valid domain list
validDomains= [
            "*.outlook.office.com",
            "mem.gfx.ms",
            "*.onenote.com",
            "weather.tile.appex.bing.com",
            "officepreviewredir.microsoft.com",
            "login.live.com",
            "*.yammer.com",
            "eus2-roaming.officeapps.live.com",
            "weu-000.forms.osi.office.net",
            "foodanddrink.services.appex.bing.com",
            "logincert.microsoftonline.com",
            "ocsp.digicert.com",
            "api.localytics.com",
            "tse1.mm.bing.net",
            "smtp.office365.com",
            "sea-odc.officeapps.live.com",
            "loginex.microsoftonline.com",
            "r3.res.outlook.com",
            "platform.linkedin.com",
            "*.itunes.apple.com",
            "*.mail.protection.outlook.com",
            "*.urlp.sfbassets.com",
            "*.verisign.net",
            "ncus-roaming.officeapps.live.com",
            "www.dropbox.com",
            "*.protection.office.com",
            "ccs.login.microsoftonline.com",
            "graph.windows.net",
            "mam.manage.microsoft.com",
            "crl.microsoft.com",
            "*.cloudapp.net",
            "*.msecnd.net",
            "data.flurry.com",
            "ocsp.entrust.net",
            "excelbingmap.firstpartyapps.oaspapps.com",
            "clientconfig.microsoftonline-p.net",
            "sas.office.microsoft.com",
            "forms.office.com",
            "skydrive.wns.windows.com",
            "securescore.office.com",
            "neu-000.forms.osi.office.net",
            "www.microsoft.com",
            "*-files.sharepoint.com",
            "eus2-000.forms.osi.office.net",
            "c.live.com",
            "api.diagnostics.office.com",
            "*.omniroot.com",
            "*.microsoftonline.com",
            "ocspx.digicert.com",
            "r3.res.office365.com",
            "p100-sandbox.itunes.apple.com",
            "api.dropboxapi.com",
            "*.search.production.us.trafficmanager.net",
            "sd.symcb.com",
            "*.public-trust.com",
            "*.acompli.net",
            "wus-000.ocws.officeapps.live.com",
            "officecdn.microsoft.com",
            "evsecure-ocsp.verisign.com",
            "autologon.microsoftazuread-sso.com",
            "*.servicebus.windows.net",
            "*.blob.core.windows.net",
            "eur.delve.office.com",
            "excelcs.officeapps.live.com",
            "skypemaprdsitus.trafficmanager.net",
            "vortex.data.microsoft.com",
            "dc.applicationinsights.microsoft.com",
            "hipservice.microsoftonline.com",
            "secure.aadcdn.microsoftonline-p.com",
            "staffhub.uservoice.com",
            "*.msappproxy.net",
            "*.onmicrosoft.com",
            "s2.symcb.com",
            "aka.ms",
            "app.box.com",
            "video.osi.office.net",
            "mail.google.com",
            "s1.symcb.com",
            "vassg142.ocsp.omniroot.com",
            "delve.office.com",
            "cacerts.digicert.com",
            "*.manage.office.com",
            "ols.officeapps.live.com",
            "forms.microsoft.com",
            "www.onedrive.com",
            "scsquery-ss-asia.trafficmanager.net",
            "domains.live.com",
            "su.symcb.com",
            "cdn.odc.officeapps.live.com",
            "home.office.com",
            "cl2.apple.com",
            "*word-edit.officeapps.live.com",
            "ssw.live.com",
            "office15client.microsoft.com",
            "www.googleapis.com",
            "wus-firstpartyapps.oaspapps.com",
            "ncus-odc.officeapps.live.com",
            "ea-000.ocws.officeapps.live.com",
            "*.msedge.net",
            "ocsredir.officeapps.live.com",
            "crl.entrust.net",
            "outlook.office365.com",
            "www.evernote.com",
            "webshell.suite.office.com",
            "spoprod-a.akamaihd.net",
            "*powerpoint.officeapps.live.com",
            "api.microsoftstream.com",
            "view.atdmt.com",
            "protection.office.com",
            "weu-000.tasks.osi.office.net",
            "portal.office.com",
            "ea-000.tasks.osi.office.net",
            "admin.microsoft.com",
            "*.api.microsoftstream.com",
            "*view.officeapps.live.com",
            "*.windows.net",
            "cdn.onenote.net",
            "*-myfiles.sharepoint.com",
            "eus2-000.ocws.officeapps.live.com",
            "*.cdn.office.net",
            "nexus.officeapps.live.com",
            "m.facebook.com",
            "api.meetup.com",
            "*excel.officeapps.live.com",
            "can.delve.office.com",
            "staffhubweb.azureedge.net",
            "device.login.microsoftonline.com",
            "accounts.accesscontrol.windows.net",
            "amp.azure.net",
            "eus-www.sway-extensions.com",
            "wikipedia.firstpartyapps.oaspapps.com",
            "support.microsoft.com",
            "sr.symcd.com",
            "ajax.microsoft.com",
            "*.teams.microsoft.com",
            "companymanager.microsoftonline.com",
            "www.wunderlist.com",
            "*.eu2.portal.cloudappsecurity.com",
            "*.dc.trouter.io",
            "neu-odc.officeapps.live.com",
            "office.live.com",
            "hip.microsoftonline-p.net",
            "*.msocdn.com",
            "weu-000.ocws.officeapps.live.com",
            "admin.onedrive.com",
            "*.sharepoint.com",
            "nps.onyx.azure.net",
            "ocsp2.globalsign.com",
            "testconnectivity.microsoft.com",
            "tasks.office.com",
            "odc.officeapps.live.com",
            "policykeyservice.dc.ad.msft.net",
            "support.content.office.net",
            "site-cdn.onenote.net",
            "s.ytimg.com",
            "videoplayercdn.osi.office.net",
            "scus-odc.officeapps.live.com",
            "weu-odc.officeapps.live.com",
            "bit.ly",
            "analytics.localytics.com",
            "staffhub.ms",
            "publiccdn.sharepointonline.com",
            "webanalytics.localytics.com",
            "ncus-000.ocws.officeapps.live.com",
            "passwordreset.microsoftonline.com",
            "*.adhybridhealth.azure.com",
            "api.passwordreset.microsoftonline.com",
            "evintl-aia.verisign.com",
            "manage.office.com",
            "*.geotrust.com",
            "c1.microsoft.com",
            "docs.live.net",
            "roaming.officeapps.live.com",
            "*.office.com",
            "*.media.azure.net",
            "telemetryservice.firstpartyapps.oaspapps.com",
            "mobile.pipe.aria.microsoft.com",
            "apps.identrust.com",
            "*.sharepointonline.com",
            "firstpartyapps.oaspapps.com",
            "wus-000.tasks.osi.office.net",
            "jpn.delve.office.com",
            "*.staffhub.office.com",
            "cdn.sharepointonline.com",
            "gbr.delve.office.com",
            "eus-zzz.tasks.osi.office.net",
            "officeredir.microsoft.com",
            "r.office.microsoft.com",
            "nexus.microsoftonline-p.com",
            "ad.atdmt.com",
            "ocsa.officeapps.live.com",
            "r1.res.office365.com",
            "apc.delve.office.com",
            "activation.sls.microsoft.com",
            "ocsp.globalsign.com",
            "uci.officeapps.live.com",
            "evintl-ocsp.verisign.com",
            "tds.configure.office.com",
            "*.o365weve.com",
            "outlook.office.com",
            "omextemplates.content.office.net",
            "dgps.support.microsoft.com",
            "msdn.microsoft.com",
            "scus-000.ocws.officeapps.live.com",
            "crl.globalsign.com",
            "evsecure-crl.verisign.com",
            "api.office.com",
            "scsinstrument-ss-us.trafficmanager.net",
            "officeclient.microsoft.com",
            "management.azure.com",
            "*.eu.portal.cloudappsecurity.com",
            "templateservice.office.com",
            "az826701.vo.msecnd.net",
            "products.office.com",
            "mrodevicemgr.officeapps.live.com",
            "a.wunderlist.com",
            "*.us.portal.cloudappsecurity.com",
            "acompli.helpshift.com",
            "*.appex-rf.msn.com",
            "officeimg.vo.msecnd.net",
            "signup.microsoft.com",
            "mscrl.microsoft.com",
            "web.localytics.com",
            "api.login.yahoo.com",
            "*.outlookmobile.com",
            "sdk.hockeyapp.net",
            "ocsp.msocsp.com",
            "*.us2.portal.cloudappsecurity.com",
            "o15.officeredir.microsoft.com",
            "becws.microsoftonline.com",
            "ocos-office365-s2s.msedge.net",
            "*.symcb.com",
            "login.microsoftonline-p.com",
            "prod.firstpartyapps.oaspapps.com.akadns.net",
            "ocsp.int-x3.letsencrypt.org",
            "accounts.google.com",
            "eus-www.sway-cdn.com",
            "*.store.core.windows.net",
            "*.search.production.emea.trafficmanager.net",
            "static.sharepointonline.com",
            "partnerservices.getmicrosoftkey.com",
            "evintl-crl.verisign.com",
            "*broadcast.officeapps.live.com",
            "www.office.com",
            "wu.client.hip.live.com",
            "login.windows.net",
            "login.microsoft.com",
            "go.microsoft.com",
            "provisioningapi.microsoftonline.com",
            "secure.globalsign.com",
            "*.tenor.com",
            "app.adjust.com",
            "crl4.digicert.com",
            "sway.com",
            "*.outlook.com",
            "outlook.uservoice.com",
            "wus-000.forms.osi.office.net",
            "officespeech.platform.bing.com",
            "ms.tific.com",
            "dc.services.visualstudio.com",
            "vassg142.crl.omniroot.com",
            "insertmedia.bing.office.net",
            "oneclient.sfx.ms",
            "*.yammerusercontent.com",
            "c.bing.com",
            "play.google.com",
            "weu-roaming.officeapps.live.com",
            "scus-roaming.officeapps.live.com",
            "www.youtube.com",
            "*.mstea.ms",
            "*.skypeforbusiness.com",
            "neu-000.tasks.osi.office.net",
            "cacert.omniroot.com",
            "*.microsoft.com",
            "*.helpshift.com",
            "odcsm.officeapps.live.com",
            "asl.configure.office.com",
            "enterpriseregistration.windows.net",
            "*.notification.api.microsoftstream.com",
            "scsquery-ss-eu.trafficmanager.net",
            "amsglob0cdnstream12.azureedge.net",
            "*.portal.cloudappsecurity.com",
            "*.us3.portal.cloudappsecurity.com",
            "crl.identrust.com",
            "connect.facebook.net",
            "*.sfbassets.com",
            "*.queue.core.windows.net",
            "www.google-analytics.com",
            "*.lync.com",
            "isrg.trustid.ocsp.identrust.com",
            "ocsp.omniroot.com",
            "officeapps.live.com",
            "account.activedirectory.windowsazure.com",
            "docs.microsoft.com",
            "*.symcd.com",
            "g.live.com",
            "web.microsoftstream.com",
            "eus-odc.officeapps.live.com",
            "cacert.a.omniroot.com",
            "*.aadrm.com",
            "*.localytics.com",
            "scsquery-ss-us.trafficmanager.net",
            "*.svc.ms",
            "www.sway.com",
            "www.acompli.com",
            "office365servicehealthcommunications.cloudapp.net",
            "wus-www.sway-cdn.com",
            "*.microsoftonline-p.com",
            "directory.services.live.com",
            "*cdn.onenote.net",
            "login.microsoftonline.com",
            "kor.delve.office.com",
            "auth.gfx.ms",
            "quicktips.skypeforbusiness.com",
            "res.delve.office.com",
            "crl3.digicert.com",
            "graph.facebook.com",
            "portal.microsoftonline.com",
            "store.office.com",
            "*.entrust.net",
            "wus-www.sway-extensions.com",
            "neu-roaming.officeapps.live.com",
            "storage.live.com",
            "d.docs.live.net",
            "signup.live.com",
            "pptcs.officeapps.live.com",
            "cert.int-x3.letsencrypt.org",
            "*.broadcast.skype.com",
            "*.users.storage.live.com",
            "www.onenote.com",
            "ind.delve.office.com",
            "*.adl.windows.com",
            "apis.live.net",
            "ecn.dev.virtualearth.net",
            "cdn.optimizely.com",
            "ea-000.forms.osi.office.net",
            "sa.symcb.com",
            "wus-roaming.officeapps.live.com",
            "assets.onestore.ms",
            "watson.telemetry.microsoft.com",
            "wordcs.officeapps.live.com",
            "*.log.optimizely.com",
            "nexusrules.officeapps.live.com",
            "compass-ssl.microsoft.com",
            "technet.microsoft.com",
            "*.azureedge.net",
            "login-us.microsoftonline.com",
            "*.skype.com",
            "*.office.net",
            "az416426.vo.msecnd.net",
            "account.office.net",
            "ajax.aspnetcdn.com",
            "*.azurerms.com",
            "*.table.core.windows.net",
            "sway.office.com",
            "watson.microsoft.com",
            "c.bing.net",
            "*.phonefactor.net",
            "account.live.com",
            "privatecdn.sharepointonline.com",
            "broadcast.skype.com",
            "*.assets-yammer.com",
            "*onenote.officeapps.live.com",
            "click.email.microsoftonline.com",
            "ocws.officeapps.live.com",
            "www.bing.com",
            "client.hip.live.com",
            "adminwebservice.microsoftonline.com",
            "staffhub.office.com",
            "*visio.officeapps.live.com",
            "suite.office.net",
            "amsglob0cdnstream11.azureedge.net",
            "*.appex.bing.com",
            "crl.globalsign.net",
            "su.symcd.com",
            "mlccdn.blob.core.windows.net",
            "wus-odc.officeapps.live.com",
            "sr.symcb.com",
            "api.informationprotection.azure.com",
            "cus-000.tasks.osi.office.net",
            "*.verisign.com",
            "videocontent.osi.office.net",
            "mshrcstorageprod.blob.core.windows.net",
            "nam.delve.office.com",
            "neu-000.ocws.officeapps.live.com",
            "*.secure.skypeassets.com",
            "s0.assets-yammer.com",
            "*.microsoftonline-p.net",
            "templates.office.com",
            "sea-000.tasks.osi.office.net",
            "officecdn.microsoft.com.edgesuite.net",
            "*.aria.microsoft.com",
            "cdp1.public-trust.com",
            "office.microsoft.com",
            "contentstorage.osi.office.net",
            "peoplegraph.firstpartyapps.oaspapps.com",
            "*.search.production.apac.trafficmanager.net",
            "www.outlook.com",
            "en-us.appex-rf.msn.com",
            "evsecure-aia.verisign.com",
            "by.uservoice.com",
            "support.office.com",
            "mlccdnprod.azureedge.net",
            "appsforoffice.microsoft.com",
            "shellprod.msocdn.com",
            "aia.entrust.net",
            "teams.microsoft.com",
            "*word-view.officeapps.live.com",
            "www.digicert.com",
            "*.outlookmobile.us",
            "login.windows-ppe.net",
            "graph.microsoft.com",
            "api.login.microsoftonline.com",
            "rink.hockeyapp.net",
            "prod.msocdn.com",
            "*.office365.com",
            "*.streaming.mediaservices.windows.net",
            "*.hockeyapp.net",
            "social.yahooapis.com",
            "r4.res.office365.com",
            "sea-roaming.officeapps.live.com",
            "ea-roaming.officeapps.live.com",
            "*.protection.outlook.com",
            "*.keydelivery.mediaservices.windows.net",
            "lam.delve.office.com",
            "browser.pipe.aria.microsoft.com",
            "aus.delve.office.com",
            "secure.meetup.com",
            "login.cylance.com",
            "data.cylance.com",
            "my.cylance.com",
            "update.cylance.com",
            "api.cylance.com",
            "download.cylance.com",
            "*.s3-us-west-1.amazonaws.com",
            "*.s3-us-west-2.amazonaws.com",
            "*.s3-us-east-1.amazonaws.com",
            "*.s3-us-east-2.amazonaws.com",
            "*.s3-ap-east-1.amazonaws.com",
            "*.s3-ap-south-1.amazonaws.com",
            "*.s3-ap-northeast-3.amazonaws.com",
            "*.s3-ap-northeast-2.amazonaws.com",
            "*.s3-ap-southeast-1.amazonaws.com",
            "*.s3-ap-southeast-2.amazonaws.com",
            "*.s3-ap-northeast-1.amazonaws.com",
            "*.s3-ca-central-1.amazonaws.com",
            "*.s3-cn-north-1.amazonaws.com",
            "*.s3-cn-northwest-1.amazonaws.com",
            "*.s3-eu-central-1.amazonaws.com",
            "*.s3-eu-west-1.amazonaws.com",
            "*.s3-eu-west-2.amazonaws.com",
            "*.s3-eu-west-3.amazonaws.com",
            "*.s3-eu-north-1.amazonaws.com",
            "*.s3-me-south-1.amazonaws.com",
            "*.s3-sa-east-1.amazonaws.com",
            "*.s3.us-west-1.amazonaws.com",
            "*.s3.us-west-2.amazonaws.com",
            "*.s3.us-east-1.amazonaws.com",
            "*.s3.us-east-2.amazonaws.com",
            "*.s3.ap-east-1.amazonaws.com",
            "*.s3.ap-south-1.amazonaws.com",
            "*.s3.ap-northeast-3.amazonaws.com",
            "*.s3.ap-northeast-2.amazonaws.com",
            "*.s3.ap-southeast-1.amazonaws.com",
            "*.s3.ap-southeast-2.amazonaws.com",
            "*.s3.ap-northeast-1.amazonaws.com",
            "*.s3.ca-central-1.amazonaws.com",
            "*.s3.cn-north-1.amazonaws.com",
            "*.s3.cn-northwest-1.amazonaws.com",
            "*.s3.eu-central-1.amazonaws.com",
            "*.s3.eu-west-1.amazonaws.com",
            "*.s3.eu-west-2.amazonaws.com",
            "*.s3.eu-west-3.amazonaws.com",
            "*.s3.eu-north-1.amazonaws.com",
            "*.s3.me-south-1.amazonaws.com",
            "*.s3.sa-east-1.amazonaws.com",
            "*.s3-us-gov-west-1.amazonaws.com",
            "*.s3-us-gov-east-1.amazonaws.com",
            "*.s3.us-gov-west-1.amazonaws.com",
            "*.s3.us-gov-east-1.amazonaws.com",
            "*.s3-fips.us-gov-west-1.amazonaws.com",
            "*.s3-fips.us-gov-east-1.amazonaws.com",
            "*.s3-fips-us-gov-west-1.amazonaws.com",
            "*.s3-fips-us-gov-east-1.amazonaws.com",
            "*.s3.dualstack.us-gov-west-1.amazonaws.com",
            "*.s3.dualstack.us-gov-east-1.amazonaws.com",
            "*.rds.amazonaws.com",
            "*.elb.amazonaws.com",
            "*.us-gov-east-1.elb.amazonaws.com",
            "*.us-gov-west-1.elb.amazonaws.com",
            "dynamodb.us-west-1.amazonaws.com",
            "dynamodb.us-west-2.amazonaws.com",
            "dynamodb.us-east-1.amazonaws.com",
            "dynamodb.us-east-2.amazonaws.com",
            "dynamodb.ap-east-1.amazonaws.com",
            "dynamodb.ap-south-1.amazonaws.com",
            "dynamodb.ap-northeast-3.amazonaws.com",
            "dynamodb.ap-northeast-2.amazonaws.com",
            "dynamodb.ap-southeast-1.amazonaws.com",
            "dynamodb.ap-southeast-2.amazonaws.com",
            "dynamodb.ap-northeast-1.amazonaws.com",
            "dynamodb.ca-central-1.amazonaws.com",
            "dynamodb.cn-north-1.amazonaws.com",
            "dynamodb.cn-northwest-1.amazonaws.com",
            "dynamodb.eu-central-1.amazonaws.com",
            "dynamodb.eu-west-1.amazonaws.com",
            "dynamodb.eu-west-2.amazonaws.com",
            "dynamodb.eu-west-3.amazonaws.com",
            "dynamodb.eu-north-1.amazonaws.com",
            "dynamodb.me-south-1.amazonaws.com",
            "dynamodb.sa-east-1.amazonaws.com",
            "dynamodb.us-gov-west-1.amazonaws.com",
            "dynamodb.us-gov-east-1.amazonaws.com",
            "*.blob.core.windows.net",
            ".*blob.core.usgovcloudapi.net",
            "*.documents.azure.com",
            "*.documents.azure.us",
            "*.database.windows.net",
            "*.database.usgovcloudapi.net"
          ]


if __name__ == "__main__":
   main(sys.argv)
            